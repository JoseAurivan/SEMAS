@using System.Linq
@using CadastroHabCMAS.Controllers
@model CadastroHabCMAS.ViewModel.CadastroCMASViewModels.LupaCadastradoViewModel

@{
    ViewBag.Title = "Lupa";
    Layout = "_Layout";
}
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link href="~/css/site.css" rel="stylesheet">
    <style>
        body{
           background-color: #E8EEF1;
        }
        .form--cadastro{
          margin: 40px 40px 40px 40px;
        }
        div > label{
          color: black;
        }
        button{
          margin-top: 15px;
        }
        .h4{
        text-align: center;
        }
    </style>
</head>
<div class="form--cadastro">
    <p class="h4">Cadastros efetuados na SEMAS</p>
    <hr>

    <div class="form-row">
        <div class="col-md-3 mb-3">
            <label for="validationTooltip01">CPF:</label>
            <div class="input-group mb-3">
                <input asp-for="PessoaEndereco.Pessoa.Cpf" readonly class="form-control">
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <label for="validationTooltip01">NIS:</label>
            <div class="input-group mb-3">
                <input asp-for="PessoaEndereco.Pessoa.CadastroCmas.Nis" readonly class="form-control">
            </div>
        </div>
    </div>
    
    <input asp-for="PessoaEndereco.Endereco.Cesta.Id" readonly class="form-control" id="cesta">
    <div id="ToChange">
        
    </div>
    
    @section Scripts
        {
            <script>
                let urlPessoaEndereco;
                function init(url) {
                    urlPessoaEndereco = url;    
                }
                
                $(document).ready(function() {
                  let url = "@Url.Action(nameof(CadastroCmasController.PV_Lupa))";                
                  init(url);
                  carregarEntregas();
                });
                
                function carregarEntregas() {
                    console.log(urlPessoaEndereco)
                    let cesta = document.getElementById("cesta").value;
                    console.log(cesta)
                    $.ajax({      
                        type: "POST",
                        url: urlPessoaEndereco,
                        data: {"CestaId":cesta},
                        success: function(response) {
                               $('#ToChange').html(response)                   
                        }
                    });    
                }   
                </script>
        }
</div>